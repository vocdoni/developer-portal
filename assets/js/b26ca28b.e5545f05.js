"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[6730],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=c(n),h=o,m=u["".concat(s,".").concat(h)]||u[h]||p[h]||r;return n?a.createElement(m,i(i({ref:t},d),{},{components:n})):a.createElement(m,i({ref:t},d))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var c=2;c<r;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},95262:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var a=n(87462),o=(n(67294),n(3905));const r={},i="Election Data Schemes",l={unversionedId:"protocol/DataSchemes/election",id:"protocol/DataSchemes/election",title:"Election Data Schemes",description:"As stated before, governance elections span across the Election Smart Contract, the Vochain and distributed file storage, providing the human readable metadata.",source:"@site/docs/protocol/10-DataSchemes/02-election.md",sourceDirName:"protocol/10-DataSchemes",slug:"/protocol/DataSchemes/election",permalink:"/protocol/DataSchemes/election",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"protocol",previous:{title:"Organization Metadata",permalink:"/protocol/DataSchemes/organization-metadata"}},s={},c=[{value:"Election Metadata",id:"election-metadata",level:2},{value:"Vote Envelope",id:"vote-envelope",level:2},{value:"When <code>envelopeType.ANONYMOUS</code> is enabled",id:"when-envelopetypeanonymous-is-enabled",level:5},{value:"When <code>envelopeType.ANONYMOUS</code> is disabled",id:"when-envelopetypeanonymous-is-disabled",level:5},{value:"Vote Package",id:"vote-package",level:2},{value:"When <code>envelopeType.ENCRYPTED_VOTE</code> is disabled",id:"when-envelopetypeencrypted_vote-is-disabled",level:5},{value:"When <code>envelopeType.ENCRYPTED_VOTE</code> is enabled",id:"when-envelopetypeencrypted_vote-is-enabled",level:5},{value:"Results",id:"results",level:2}],d={toc:c};function p(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"election-data-schemes"},"Election Data Schemes"),(0,o.kt)("p",null,"As stated before, governance elections span across the Election Smart Contract, the Vochain and distributed file storage, providing the human readable metadata. "),(0,o.kt)("p",null,"Along the different stages of a governance election, the following data schemes are used:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#election-metadata"},"Election metadata")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#vote-envelope"},"Vote Envelope")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#vote-package"},"Vote Package")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#results"},"Results"))),(0,o.kt)("h2",{id:"election-metadata"},"Election Metadata"),(0,o.kt)("p",null,"The creation of this data structure is critical. Multiple checks should be in place to ensure that the data is coherent (well formatted, all relevant locales present, etc)."),(0,o.kt)("p",null,"The Election Metadata defines the human readable information and should not be confused with the Election Parameters in the Smart Contract, which define how the election should behave."),(0,o.kt)("p",null,"The metadata of a election is represented as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "version": "1.1", // Protocol version\n    "title": {\n        "en": "Universal Basic Income",\n        "ca": "Renda B\xe0sica Universal"\n    },\n    "description": {\n        "en": "The description goes here",\n        "ca": "La descripci\xf3 va aqu\xed"\n    },\n    "media": {\n        "header": "<content uri>",\n        "streamUri": "https://.../"\n    },\n    "questions": [\n        {\n            "title": {\n                "en": "Should universal basic income become a human right?",\n                "ca": "Est\xe0s d\'acord amb que la renda b\xe0sica universal sigui un dret hum\xe0?"\n            },\n            "description": {\n                "en": "The description goes here",\n                "ca": "La descripci\xf3 va aqu\xed"\n            },\n            "choices": [\n                {\n                    "title": {\n                        "en": "Yes",\n                        "ca": "S\xed"\n                    },\n                    "value": 0\n                },\n                {\n                    "title": {\n                        "en": "No",\n                        "ca": "No"\n                    },\n                    "value": 1\n                }\n            ]\n        }\n    ],\n    "results": {\n        "aggregation": "index-weighted", // "index-weighted" | "discrete-counting",\n        "display": "rating" // "rating" | "simple-question" | "multiple-choice" | "linear-weighted" | "quadratic-voting" | "multiple-question" | "raw"\n    }\n}\n')),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"results")," fields are informational only. Regardless of the chosen ",(0,o.kt)("inlineCode",{parentName:"p"},"aggregation")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"display"),", the scrutiny is the same for all cases. However, these fields help the UI components to interpret and display the results according to the ",(0,o.kt)("a",{parentName:"p",href:"/protocol/ballot"},"ballot protocol")),(0,o.kt)("h2",{id:"vote-envelope"},"Vote Envelope"),(0,o.kt)("p",null,"The Vote Envelope contains a (possibly encrypted) Vote Package and provides details to prove that the incoming vote is valid. Some fields may be optional depending on the election ",(0,o.kt)("inlineCode",{parentName:"p"},"mode")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"envelopeType"),"."),(0,o.kt)("h5",{id:"when-envelopetypeanonymous-is-enabled"},"When ",(0,o.kt)("inlineCode",{parentName:"h5"},"envelopeType.ANONYMOUS")," is enabled"),(0,o.kt)("p",null,"This section will be available soon."),(0,o.kt)("h5",{id:"when-envelopetypeanonymous-is-disabled"},"When ",(0,o.kt)("inlineCode",{parentName:"h5"},"envelopeType.ANONYMOUS")," is disabled"),(0,o.kt)("p",null,"A signed (non-anonymous) Vote Envelope features the election ID, the Census Merkle Proof of the user, a nonce to prevent replay attacks, the index of the encryption keys used, a Base64 representation of the Vote Package and the user's signature."),(0,o.kt)("p",null,"In order to guarantee 100% reproduceability of the signature, the Vote Envelope is encoded as a Protobuf model and serialized into a byte array. This byte array is then signed and both fields are sent via a ",(0,o.kt)("inlineCode",{parentName:"p"},"SignedTx")," model to a Gateway. "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-proto"},"// Protobuf models\n\nmessage VoteEnvelope {\n        bytes nonce = 1;  // Unique number per vote attempt, so that replay attacks can't reuse this payload\n        bytes electionId = 2;  // The election for which the vote is cast\n        Proof proof = 3;  // One of ProofGraviton, ProofIden3, ProofEthereumStorage, ProofEthereumAccount, or ProofCA\n        bytes votePackage = 4;   // JSON string of the Vote Package, encoded as bytes. It may be encrypted.\n        bytes nullifier = 5;  // Hash of the private key + electionId (optional, depending on the type)\n\n        repeated uint32 encryptionKeyIndexes = 6; // On encrypted votes, contains the (sorted) indexes of the keys used to encrypt\n}\n\n// ...\n\nmessage Tx {\n    oneof payload {\n        VoteEnvelope vote = 1;\n        // ...\n    }\n}\n\nmessage SignedTx {\n    bytes tx = 1; // The bytes produced by Marshaling a Tx{} message\n    optional bytes signature = 2; // The signature for the tx bytes. \n    // signature is only required in those transactions that actually need a signature.\n        // I.e zk-SNARKs based transactions won't needed, however the transaction should use\n        // this message type in order to preserve consistency on the Vochain\n}\n\n")),(0,o.kt)("h2",{id:"vote-package"},"Vote Package"),(0,o.kt)("p",null,"Contains the actual votes and is part of the Vote Envelope."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "nonce": "01234567890abcdef", // 8+ byte random string to prevent guessing the encrypted payload before the reveal key is released\n    "votes": [  // Directly mapped to the `questions` field of the metadata\n        1, 3, 2\n    ]\n}\n')),(0,o.kt)("h5",{id:"when-envelopetypeencrypted_vote-is-disabled"},"When ",(0,o.kt)("inlineCode",{parentName:"h5"},"envelopeType.ENCRYPTED_VOTE")," is disabled"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"nonce")," can be omitted."),(0,o.kt)("li",{parentName:"ul"},"The package has to be serialized as a JSON string and encoded as bytes.")),(0,o.kt)("h5",{id:"when-envelopetypeencrypted_vote-is-enabled"},"When ",(0,o.kt)("inlineCode",{parentName:"h5"},"envelopeType.ENCRYPTED_VOTE")," is enabled"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"nonce")," is mandatory."),(0,o.kt)("li",{parentName:"ul"},"The package has to be serialized as a JSON string encoded as bytes."),(0,o.kt)("li",{parentName:"ul"},"It must be encrypted with a subset of the public keys or all of them."),(0,o.kt)("li",{parentName:"ul"},"The index of the public keys used to encrypt must be included in the Vote Envelope in the exact order they have been used.")),(0,o.kt)("h2",{id:"results"},"Results"),(0,o.kt)("p",null,"Requests to the Results API will return an Array of number arrays, following the ",(0,o.kt)("a",{parentName:"p",href:"protocol/ballot"},"Ballot Protocol"),". They will contain a bi-dimensional array of integers, aggregating the values currently stored on the Vochain."),(0,o.kt)("p",null,"The interpretation of these values is left to the Client apps, and is determined by the ",(0,o.kt)("inlineCode",{parentName:"p"},"results.aggregation")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"results.display")," fields of the Election Metadata, listed above."))}p.isMDXComponent=!0}}]);